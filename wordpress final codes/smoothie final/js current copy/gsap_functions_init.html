<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", () => {
    document.fonts.ready.then(gsap_animations_init);
  });

  let splitInstances = [];

  function gsap_animations_init() {
    requestAnimationFrame(() => {
      // Revert old splits before making new ones
      splitInstances.forEach((inst) => inst.revert());
      splitInstances = [];

      // Rebuild split text and store instances
      splitInstances.push(
        new SplitType(
          ".gsap_text-container h1, .gsap_text-container h2, .gsap_text-container h3, .gsap_text-container h4, .gsap_text-container p, .gsap-footer-our-mission h1"
        )
      );

      // Rebuild animations
      text_func();
      footer_sphere_animation();
    });
  }

  // On resize: clean triggers, re-split text, refresh
  let resizeTimer;
  window.addEventListener("resize", () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(() => {
      gsap_animations_init();
      ScrollTrigger.refresh();
    }, 250);
  });
</script>
